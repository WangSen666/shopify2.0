{%- style -%}
  .order-process-title {
    text-align: center;
  }
  .order-process-title-border {
    width: 100px;
    height: 2px;
    background: #9ED835;
    margin: 14px auto;
    display: block !important;
  }
  .order-process-box {
    margin: 44px 0;
    position: relative;
  }
  .order-process-line-box {
    position: absolute;
    width: 3px;
    height: 100%;
    display: block !important;
    left: 50%;
    top: 0;
  }
  .order-process-line {
    width: 3px;
    position: absolute;
    /* left:50%; */
    display: block !important;
    top: calc(10%);
    @media screen and (max-width:1440px) {
      top: calc(10%);
    }

    @media screen and (max-width:990px) {
      display: none !important;
    }
  }
  .line-yellow {
    height: 21%;
    background: #9ED835;
    z-index: 2;
  }
  .line-default {
    height: calc(80%);
    background: #888988;
  }
  .process-item {
    display: flex;
    justify-content: space-around;
    position: relative;
  }
  .row-reverse {
    flex-direction: row-reverse;
  }
  .process-wrapper {
    box-shadow: 0 0 14px #807373;
    border-radius: 14px;
    width: 426px;
    /*     height:426px; */
  }
  .process-number-wrapper {
    display: flex;
    flex-direction: column;
    justify-content: center;
  }
  .process-img {
    height: 224px;
    border-top-left-radius: 14px;
    border-top-right-radius: 14px;
    width: 100%;
  }
  .process-text {
    padding: 14px;
  }
  .process-button {
    margin: 24px auto;
    display: block;
    width: 180px;
    background: #9ED835;
    height: 40px;
    line-height: 40px;
    border-radius: 14px;
    color: #fff;
    font-size: 16px;
    text-align: center;
  }
  .process-number {
    width: 50px;
    height: 50px;
    border-radius: 26px;
    text-align: center;
    line-height: 50px;
    background: #2E5955 !important;
    color: #fff;
    margin: 24px auto;
    font-size: 24px;
  }

  .process-text-1 {
    background: #eeeeee;
    width: 360px;
    border-radius: 14px;
    line-height: 50px;
    font-size: 20px;
    text-align: center;
    margin: 24px auto;
    box-shadow: 0 0 8px #807373;
  }
  .order-process-byte-box {
    display: block !important;
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    height: 100%;
    width: 14px;
    height: 14px;
    border-radius: 8px;
    background: #888988;
    display: block !important;
    z-index: 3;
  }
  .order-process-byte-box-1 {
    top: 10%;
  }
  .order-process-byte-box-2 {
    top: 30%;
  }
  .order-process-byte-box-3 {
    top: 50%;
  }
  .order-process-byte-box-4 {
    top: 70%;
  }
  .order-process-byte-box-5 {
    top: 90%;
  }
  /* .line-byte {
    width: 14px;
    height: 14px;
    border-radius: 8px;
    background: #888988;
    display: block !important;
    position: absolute;
    left: 50%;
    transform: translateX(-40%);
    top: 50%;
    z-index: 3;
  } */

  .order-process-byte-box:first-child {
    background: #9ED835;
  }
  .process-item:last-child .order-process-line-bottom {
    display: none !important
  }

  @media screen and (max-width:1400px) {
    .order-process-title {
      font-size: 36px !important;
    }
    .order-process-box {
      margin: 24px 0;
    }
    .process-wrapper {
      width: 346px;
    }
    .process-text {
      font-size: 14px;
    }
    .process-text-1 {
      width: 266px;
      font-size: 16px;
    }
  }
  @media screen and (max-width:990px) {
    .order-process-byte-box {
      right: 8px;
      left: unset;
    }
    .process-text{
      line-height:18px;
    }
    .order-process-line-box {
      right: 0;
      left: unset;
    }
    .process-item {
      flex-direction: column-reverse !important;
      margin: 0 auto;
      width: 90%;
    }
    .process-button{
      margin: 14px auto;
      height: 30px;
      line-height: 30px;
    }
    .process-wrapper {
      width: 90%;
      height: unset;
      margin: 0 auto;
    }
    .process-img{
      height:130px;
    }
    .process-number-wrapper {
      flex-direction: row;
      justify-content: flex-end;
      width: 90%;
      margin: 24px auto;
      align-items: center;
    }
    .process-number {
      width: 30px;
      height: 30px;
      font-size: 16px;
      /* line-height: 30px; */
      margin: 0 14px 0 0;
      font-weight:900;
      padding:6px;
    }
    .process-text-1 {
      margin: 0;
      font-size:14px;
      line-height:30px;
      padding:10px 0;
      width:246px;
    }
    .order-process-byte-box-1 {
      top: 2%;
    }
    .order-process-byte-box-2 {
      top: 24%;
    }
    .order-process-byte-box-3 {
      top: 43%;
    }
    .order-process-byte-box-4 {
      top: 63%;
    }
    .order-process-byte-box-5 {
      top: 82.5%;
    }
    .line-default{
      display:block !important;
      right:20px;
      top:2%;
      height:81%;
    }
    .line-yellow{
      display:block !important;
      right:20px;
      top:2%;
    }
  }
{%- endstyle -%}

<div class="order-process page-width">
  <h2 class="order-process-title" style="font-size:{{ section.settings.heading_size }}px;">{{ section.settings.heading }}</h2>
  <div class="order-process-title-border"></div>
  <div class="order-process-box">
    <div class="order-process-line-box">
      <!-- /* press_num */ -->
      {% for i in(1..5) %}
        <div class="order-process-byte-box order-process-byte-box-{{i}}">
          <div class="line-byte"></div>
        </div>
      {% endfor %}
      <div class="order-process-line line-yellow"></div>
      <div class="order-process-line line-default"></div>
    </div>


    {% for block in section.blocks %}
      {%- case block.type -%}
        {% when "process_item" %}
        <div class="process-item {% if block.settings.content_position=="right" %}row-reverse{% endif %}">
          <div class="process-wrapper">
            <div class="process-img" style="background:url('{{  block.settings.process_img|image_url }}') no-repeat center center;background-size:cover;"><!--               <img src="{{ block.settings.process_img|image_url }}" /> -->
            </div>
            <div class="process-text">{{ block.settings.process_text }}</div>
            {%- if block.settings.button_link != blank -%}
              <a target="_blank" {% if block.settings.button_link == blank %}role="link"aria-disabled="true"{% else %}href="{{ block.settings.button_link }}"{% endif %}class="process-button button{% if block.settings.button_style_secondary %} button--secondary{% else %} button--primary{% endif %}">{{ block.settings.button_label | escape }}</a>
            {%- endif -%}

          </div>

          <div class="process-number-wrapper">
            <div class="process-number">{{ block.settings.process_number }}</div>
            <div class="process-text-1">{{ block.settings.process_text_1 }}</div>
          </div>

        </div>
      {% endcase %}
    {% endfor %}


  </div>
</div>

<script>
  window.onload = function() {
    const scrollTop = document.documentElement.scrollTop;
    const order_process_box = document.getElementsByClassName('order-process-box')[0]
    console.log("scrollTop", scrollTop)

// scrollX = window.scrollX


    window.addEventListener('scroll', function() {
      const windowWidth=document.documentElement.clientWidth;
      const scrollTop = document.documentElement.scrollTop;
      const order_process_box = document.getElementsByClassName('order-process-box')[0]
      var bytes = document.getElementsByClassName('order-process-byte-box')
      const scrollHeight = scrollTop - order_process_box.offsetTop;
      $('.line-yellow').css({
        height: scrollHeight + "px"
      })
      if(windowWidth<990){
        $('.line-yellow').css({
          height: scrollHeight+180 + "px"
        })
      }
      const line_yellow_height = $('.line-yellow').height();
      const line_default_height = $('.line-default').height();
      console.log("line_yellow_height",line_yellow_height)
      console.log("line_default_height",line_default_height)
      
// 黄条元素高度不能大于灰条元素的高度
      if (line_yellow_height >= line_default_height) {
        $('.line-yellow').css({
          height: line_default_height + "px"
        })
      }
      if (line_yellow_height >= line_default_height / 4 && line_yellow_height < line_default_height * 2 / 4) {
        bytes[1].style.backgroundColor = "#9ED835";
        bytes[2].style.backgroundColor = "#888988";
        bytes[3].style.backgroundColor = "#888988";
        bytes[4].style.backgroundColor = "#888988";
      } else if (line_yellow_height >= line_default_height * 2 / 4 && line_yellow_height < line_default_height * 3 / 4) {

        bytes[1].style.backgroundColor = "#9ED835";
        bytes[2].style.backgroundColor = "#9ED835";
        bytes[3].style.backgroundColor = "#888988";
        bytes[4].style.backgroundColor = "#888988";
      } else if (line_yellow_height >= line_default_height * 3 / 4 && line_yellow_height < line_default_height) {

        bytes[1].style.backgroundColor = "#9ED835";
        bytes[2].style.backgroundColor = "#9ED835";
        bytes[3].style.backgroundColor = "#9ED835";
        bytes[4].style.backgroundColor = "#888988";
      } else if (line_yellow_height >= line_default_height) {
        bytes[1].style.backgroundColor = "#9ED835";
        bytes[2].style.backgroundColor = "#9ED835";
        bytes[3].style.backgroundColor = "#9ED835";
        bytes[4].style.backgroundColor = "#9ED835";
      } else {
        bytes[1].style.backgroundColor = "#888988";
        bytes[2].style.backgroundColor = "#888988";
        bytes[3].style.backgroundColor = "#888988";
        bytes[4].style.backgroundColor = "#888988";
      }

    })
  }
</script>



{% schema %}
  {
    "name": "order process",
    "settings": [
      {
        "type": "text",
        "id": "heading",
        "label": "标题"
      }, {
        "type": "range",
        "id": "heading_size",
        "min": 12,
        "max": 60,
        "default": 24,
        "step": 2,
        "label": "标题尺寸"
      }, {
        "type": "text",
        "id": "press_num",
        "label": "元素数量",
        "default": "1"
      }
    ],
    "blocks": [
      {
        "type": "process_item",
        "name": "时间线内容",
        "limit": 5,
        "settings": [
          {
            "type": "image_picker",
            "id": "process_img",
            "label": "图片内容"
          },
          {
            "type": "text",
            "id": "process_text",
            "label": "时间线元素文案"
          },
          {
            "type": "text",
            "id": "process_text_1",
            "label": "时间线序号下文案"
          },
          {
            "type": "text",
            "id": "button_label",
            "default": "Button label",
            "label": "按钮文案"
          }, {
            "type": "url",
            "id": "button_link",
            "label": "按钮链接"
          }, {
            "type": "text",
            "id": "process_number",
            "label": "时间线序号"
          }, {
            "type": "select",
            "id": "content_position",
            "options": [
              {
                "value": "left",
                "label": "左边"
              }, {
                "value": "right",
                "label": "右边"
              }
            ],
            "default": "left",
            "label": "文案内容位置"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "order process",
        "blocks": [
          {
            "type": "process_item"
          }
        ]
      }
    ]
  }
{% endschema %}